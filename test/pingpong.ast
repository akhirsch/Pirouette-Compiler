helper
  curr :=
  let
    Pong.x := [Ping] Ping.(curr) ~> Pong;
  in
    let
      Pong.y := Pong.(x - 1);
    in
      if
        Pong.(x > 0)
      then
        Pong[L] ~> Ping;
        let
          Ping.x := [Pong] Pong.(y) ~> Ping;
        in
          Ping.(helper) Ping.(x)
      else
        Pong[R] ~> Ping;
        let
          Ping.x := [Pong] Pong.(y) ~> Ping;
        in
          Ping.(print_endline) Ping.("done");
main := let
          Ping.x := Ping.(100);
        in
          helper Ping.(x);
